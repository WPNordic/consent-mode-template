___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "WP Nordic - Cookie Care Consent Mode v2",
  "categories": ["TAG_MANAGEMENT", "UTILITY" ]
  "brand": {
    "id": "cookie_care",
    "displayName": "cookie-care",
    "thumbnail": "data:image/png;base64,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Pvjgg//W7QOYs6YbsmbIzpk1M4TG0VjzGaeHDphVBA6AMFwWBxCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARCGwAEQhsABEIbAARDm/wEcJ8xwQFfMcAAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Manage Google Ads \u0026 Analytics tags based on Cookie Care user consent.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "PARAM_TABLE",
    "name": "defaultSettings",
    "displayName": "Default settings",
    "paramTableColumns": [
      {
        "param": {
          "type": "SELECT",
          "name": "ad_storage",
          "displayName": "Ad storage",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "ad_user_data",
          "displayName": "Ad user data",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "ad_personalization",
          "displayName": "Ad personalization",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "analytics_storage",
          "displayName": "Analytics storage",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "functionality_storage",
          "displayName": "Functionality storage",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "SELECT",
          "name": "personalization_storage",
          "displayName": "Personalization storage",
          "macrosInSelect": false,
          "selectItems": [
            {
              "value": "denied",
              "displayValue": "denied"
            },
            {
              "value": "granted",
              "displayValue": "granted"
            }
          ],
          "simpleValueType": true
        },
        "isUnique": false
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "wait_for_update",
    "displayName": "Wait for update",
    "simpleValueType": true,
    "defaultValue": 15000,
    "help": "The cookie notice might not always run before your Google tags.To handle such situations, specify wait for update along with a millisecond value to control how long to wait before data is sent. We recommend 500ms for banners and 15000ms for overlays/popups."
  },
  {
    "type": "CHECKBOX",
    "name": "url_passthrough",
    "checkboxText": "Url passthrough",
    "simpleValueType": true,
    "help": "Use URL passthrough to track ad clicks and analytics without cookies by appending ad, client, and session IDs to URLs. Ensure your Google tag is consent-aware, URL passthrough is enabled, consent mode is implemented, links refer to the same domain, and a GCLID or DCLID is included."
  },
  {
    "type": "CHECKBOX",
    "name": "ads_data_redaction",
    "checkboxText": "Ads data redaction",
    "simpleValueType": true,
    "help": "When ads_data_redaction is true and ad_storage is denied, ad click identifiers sent by Google Ads and Floodlight tags will be redacted and sent through a cookieless domain."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const callInWindow = require('callInWindow');
const gtagSet = require('gtagSet');
const getCookieValues = require('getCookieValues');
const makeInteger = require('makeInteger');
const localStorage = require('localStorage'); 
const JSON = require('JSON');
const Object = require('Object');

/*
 *   Called when consent changes. Assumes that consent object contains keys which
 *   directly correspond to Google consent types.
 */
const onUserConsent = (consent) => {  
  
  const securityConsent = 'granted'; // Always granted in this setup
  
   const consentModeStates = {
    ad_storage: consent.ad_storage,
    ad_user_data: consent.ad_user_data,
    ad_personalization: consent.ad_personalization,
    analytics_storage: consent.analytics_storage,
    functionality_storage: consent.functionality_storage,
    personalization_storage: consent.personalization_storage,
    security_storage: securityConsent,
  };
  updateConsentState(consentModeStates);
  
  gtagSet({
    'developer_id.dMDUxNz': true,
    'url_passthrough': !!data.url_passthrough,
    'ads_data_redaction': consent.ad_storage === 'denied' && !!data.ads_data_redaction
  });
};

const setSettings = (rowSetting) => ({
  ad_storage: rowSetting.ad_storage || 'denied',
  ad_user_data: rowSetting.ad_user_data || 'denied',
  ad_personalization: rowSetting.ad_personalization || 'denied',
  analytics_storage: rowSetting.analytics_storage || 'denied',
  functionality_storage: rowSetting.functionality_storage || 'denied',
  personalization_storage: rowSetting.personalization_storage || 'denied',
  security_storage: rowSetting.security_storage || 'denied',
  wait_for_update: makeInteger(data.wait_for_update) || 15000,
});

const handleDefaultsSettings = (settingsRows) => {
     settingsRows.forEach((row) => {
     let settings = {};
    
       settings = setSettings(row);
      setDefaultConsentState(settings);
   });
  
};

/*
 *   Executes the default command, sets the developer ID
 */
const setDefaults = () => {
  
 const defaultSettings = data.defaultSettings || [];
  const defaultWithConsent = JSON.parse(localStorage.getItem('cookieCareConsentMode'));
  
  if(defaultWithConsent && Object.keys(defaultWithConsent).length > 0){
    setDefaultConsentState(defaultWithConsent);
  }
  else{
    if(defaultSettings.length > 0) {
      handleDefaultsSettings(defaultSettings);
    } else {
      let defaultSettings = {};
      defaultSettings = setSettings({});
      setDefaultConsentState(defaultSettings);
    }
    
 }

  /*
   * Optional settings using gtagSet
   */
  gtagSet({
    'developer_id.dMDUxNz': true,
    'url_passthrough': !!data.url_passthrough,
    'ads_data_redaction': !!data.ads_data_redaction
  });
};

/*
 *   Executes the default command, sets the developer ID, and sets up the consent
 *   update callback
 */
const main = () => {
 
   setDefaults();
  
  callInWindow('CookieCare.addCustomEventListenerGTMConsentModeTemplate', onUserConsent);
  data.gtmOnSuccess();
};

main();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "CookieCare.addCustomEventListenerGTMConsentModeTemplate"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtagSet"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "developer_id.dMDUxNz"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              },
              {
                "type": 1,
                "string": "ads_data_redaction"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "cookie-care-consent"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "cookieCareConsentMode"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []
setup: ''


___NOTES___

Created on 4.3.2024 14.00.07


